<html layout:decorate="global/layouts/layout" xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/html">

<div layout:fragment="content" class="mx-auto ">

    <th:block th:fragment="custom-css">
        <style>
            .concert-info {
                display: flex;
                justify-content: space-between;
                margin-top: 50px;
                margin-right: 20px;
            }

            .concert-info2 {
                margin-top: 50px; /* 각 요소 사이의 간격 설정 */
            }

            .concert-info2 span:nth-child(2) {
                margin-left: 20px;
            /
            }

            .concert-info span:nth-child(2) {
                margin-left: 20px;
            }

        </style>
    </th:block>

    <div class="artboard artboard-horizontal phone-6 border ">
        <div class="artboard artboard-horizontal phone-1 border mx-auto">
            <div class="grid h-20 card bg-base-300 rounded-box place-items-center" style="justify-content: flex-start">
                <h2 th:text="${concertDTO.getConcertNameKr()}"></h2>
            </div>

            <div>
                <div class="concert-info">
                    <div>
                        <span>장소 </span><span th:text="${concertDTO.getPlaceId()}"></span>
                    </div>

                    <div>
                        <span>장르 </span><span th:text="${concertDTO.getCategory()}"></span>
                    </div>
                </div>

                <div class="concert-info2">
                    <span>공연 기간 </span>


                    <!--공연 시작 날짜-->
                    <span th:text="${#temporals.format(concertDateDTO.getFirst().getStartTime(), 'yyyy-MM-dd')}"></span>
                    ~

                    <!--공연 종료 날짜-->
                    <span th:text="${#temporals.format(concertDateDTO.getLast().getEndTime(), 'yyyy-MM-dd')}"></span>


                </div>

            </div>

            <div class="concert-info">
                <div>
                    <span>관람 시간 </span><span th:text="${viewingTime.toMinutes()}"></span>분

                </div>

                <div>
                    <span>가격 </span><span th:text="${concertDTO.getSeatPrice()}"></span>원
                </div>
            </div>

        </div>

    </div>

    <div class="flex flex-col w-full border-opacity-50">

        <div class="flex w-full">
            <div class="grid h-20 flex-grow card bg-base-300 rounded-box place-items-center">

                <select class="select select-bordered select-lg w-full max-w-xs" id="concertDateSelect">
                    <option value="0">예매 일자를 선택해주세요</option>
                    <option th:each="concertDate : ${concertDateDTO}" th:value="${concertDate.concertDateId}" th:utext="${concertDate.getStartTime()}"></option>
                </select>

            </div>

            <div class="divider divider-horizontal"></div>

            <div class="grid h-20 flex-grow card bg-base-300 rounded-box place-items-center">

                <div>
                    <form id="seatForm" th:action="|/concert/${concertDTO.concertId}/seat|" method="POST">
                        <input type="hidden" name="concertDateId" value="0">
                        <button id="submitButton" class="bg-blue-500 text-white p-3 rounded-md hover:bg-blue-600 focus:outline-none focus:shadow-outline-blue" type="submit">예매하기</button>
                    </form>
                </div>
            </div>
        </div>
        <div class="divider"></div> <!--중간 라인-->

        <div role="tablist" class="tabs tabs-lifted tabs-lg">
            <input type="radio" name="my_tabs_2" role="tab" class="tab" aria-label="상세정보" />
            <div role="tabpanel" class="tab-content bg-base-100 border-base-300 rounded-box p-6"></div>

            <input type="radio" name="my_tabs_2" role="tab" class="tab" aria-label="리뷰" checked />
            <div role="tabpanel" class="tab-content bg-base-100 border-base-300 rounded-box p-6">

                <!--답변 입력창 시작-->
                <div class="mt-20" >
                    <form th:action="@{|/review/${concertDTO.getConcertId()}|}" method="post" onsubmit="submitWriteForm(this); return false;">

                        <textarea class ="textarea textarea-bordered w-full" id="content" name="content"  rows="4" cols="50" placeholder="리뷰를 입력하세요..."></textarea><br>

                        <button class="btn btn-neutral">댓글 작성</button>
                    </form>
                </div>

            </div>

            <input type="radio" name="my_tabs_2" role="tab" class="tab" aria-label="Tab 3" />
            <div role="tabpanel" class="tab-content bg-base-100 border-base-300 rounded-box p-6">Tab content 3</div>
        </div>


        <!-------------------여기 까지 컨텐츠 영역-------------------------------------->
    </div>
    <!---------------------------------------여기 까지 phone-6-------------------------->
</div>

<div layout:fragment="script">
    <script th:inline="javascript">
        window.onload = function() {
            var errorMessage = /*[[${errorMessage}]]*/ null;
            if (errorMessage) {
                alert(errorMessage);
            }
        };


        document.getElementById('submitButton').addEventListener('click', function(event) {
            if (!submitConcertDate(document.getElementById('seatForm'))) {
                event.preventDefault();
            }
        });

        function submitConcertDate(form) {
            var concertDateSelectElement = document.getElementById('concertDateSelect');
            var concertDateId = concertDateSelectElement.options[concertDateSelectElement.selectedIndex].value;

            if (concertDateId.length == 0 || concertDateId == 0) {
                alert('날짜를 선택해주세요.');
                return false;
            }

            form.concertDateId.value = concertDateId;
            return true;
        }
    </script>
</div>
</html>

